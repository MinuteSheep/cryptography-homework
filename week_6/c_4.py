import binascii
from gmpy2 import (
    t_divmod,
    powmod,
)

from week_6.c_1 import N, p, q

ciphertext = 22096451867410381776306561134883418017410069787892831071731839143676135600120538004282329650473509424343946219751512256465839967942889460764542040581564748988013734864120452325229320176487916666402997509188729971690526083222067771600019329260870009579993724077458967773697817571267229951148662959627934791540

phi_N = N - p - q + 1

e = 65537

for i in range(1, 100000):
    d, r = t_divmod((phi_N * i + 1), e)
    if r == 0:
        break

x = powmod(ciphertext, d, N)
x = hex(x)
m = x.split('00')[1]
print(binascii.unhexlify(m))
